<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script type="text/javascript" src="/public/js/jquery.ui.map.js"></script>


{% if page.title == 'Map' %}
    <script>
    //{ 'center': '42.345573,-71.098326' }
    $('#map_canvas').gmap({ 'center': '46,-116' }).bind('init', function() { 
      $.getJSON( '/json/markers.json', function(data) { 
        $.each( data.markers, function(i, marker) {
          $('#map_canvas').gmap('addMarker', { 
            'position': new google.maps.LatLng(marker.latitude, marker.longitude), 
            'bounds': false 
          }).click(function() {
            $('#map_canvas').gmap('openInfoWindow', { 'content': marker.title }, this);
          });
        });
      });
    });
    </script>
{% endif %}


{% if page.latitude %}
    <script>
    //{ 'center': '42.345573,-71.098326' }
    $('#map_canvas').gmap({ 'center': '{{page.latitude}},{{page.longitude}}', 'zoom': 12 }).bind('init', function() { 
      $('#map_canvas').gmap('addMarker', { 'position': '{{page.latitude}},{{page.longitude}}', 'bounds': false } );
    });
    </script>
{% endif %}